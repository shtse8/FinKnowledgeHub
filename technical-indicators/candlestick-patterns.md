# Candlestick Patterns

Candlestick patterns are graphical representations of price movements used in technical analysis to predict future market behavior. Originating in Japan over 300 years ago, these patterns provide detailed insights into market psychology, showing the relationship between opening, closing, high, and low prices within specific time periods.

## Historical Background

### Japanese Origins

Candlestick charting began in the 18th century with a Japanese rice trader named Munehisa Homma. Trading in the Dojima Rice Exchange in Osaka, Homma developed a method of technical analysis to track market prices and patterns. His techniques, refined over time, eventually evolved into the candlestick charting system.

The original Japanese name for candlestick charts was "Sakata charts," named after Homma's hometown. These methods remained relatively unknown outside Japan until the 1990s.

### Western Adoption

Candlestick charting techniques were introduced to the Western world primarily through Steve Nison's 1991 book, "Japanese Candlestick Charting Techniques." This groundbreaking work translated and explained the ancient Japanese methods for modern markets, leading to widespread adoption among Western traders and analysts.

By the late 1990s and early 2000s, with the rise of electronic trading platforms, candlestick charts became standard across global markets, largely replacing the traditional bar and line charts that had dominated Western technical analysis.

## Fundamental Components

### Anatomy of a Candlestick

Each candlestick represents price action during a specific time period and consists of several components:

- **Body**: The rectangular part of the candlestick, representing the range between the opening and closing prices
  - **Bullish (White/Green) Candle**: Close is higher than open
  - **Bearish (Black/Red) Candle**: Close is lower than open

- **Shadows/Wicks**: The thin lines extending from the body
  - **Upper Shadow**: Represents the highest price during the period
  - **Lower Shadow**: Represents the lowest price during the period

- **Time Period**: Candlesticks can represent any time interval, from 1-minute to monthly charts

### Reading Price Action

Candlesticks convey multiple pieces of information at a glance:

- **Trend Direction**: Series of bullish or bearish candles indicate market direction
- **Price Range**: Length of the candle and its shadows show volatility
- **Market Sentiment**: Specific patterns reflect changes in buying and selling pressure
- **Opening/Closing Relationship**: Shows which side (buyers or sellers) won the period
- **Price Rejection**: Long shadows indicate rejection of price levels

## Single Candlestick Patterns

### Bullish Single Candle Patterns

- **Hammer**: Small body near the top with a long lower shadow (at least twice the body length) and minimal upper shadow. Found in downtrends, suggests potential reversal.

- **Bullish Engulfing**: Large bullish candle that completely engulfs the previous day's smaller bearish candle. Indicates strong buying pressure.

- **Dragonfly Doji**: Doji with a long lower shadow and no upper shadow. The open, high, and close prices are at the same level. Indicates rejection of lower prices.

- **Bullish Marubozu**: Long bullish candle with no shadows. Demonstrates strong bullish sentiment with buyers in control throughout the period.

- **Inverted Hammer**: Small body near the bottom with a long upper shadow (at least twice the body length) and minimal lower shadow. Found in downtrends, suggests potential reversal.

### Bearish Single Candle Patterns

- **Hanging Man**: Resembles a hammer but appears during an uptrend. Small body near the top with a long lower shadow. Signals potential downward reversal.

- **Bearish Engulfing**: Large bearish candle that completely engulfs the previous day's smaller bullish candle. Indicates strong selling pressure.

- **Gravestone Doji**: Doji with a long upper shadow and no lower shadow. The open, low, and close are at the same level. Indicates rejection of higher prices.

- **Bearish Marubozu**: Long bearish candle with no shadows. Shows strong bearish sentiment with sellers in control throughout the period.

- **Shooting Star**: Small body near the bottom with a long upper shadow (at least twice the body length) and minimal lower shadow. Found in uptrends, suggests potential reversal.

### Neutral Patterns

- **Doji**: Open and close prices are virtually equal, creating a cross shape. Represents market indecision.

- **Spinning Top**: Small body with upper and lower shadows longer than the body. Indicates uncertainty in the market.

- **Long-Legged Doji**: Doji with long upper and lower shadows. Shows extreme volatility and indecision.

- **Four Price Doji**: Extremely rare pattern where open, high, low, and close are all at the same price. Indicates complete market standstill.

## Multiple Candlestick Patterns

### Bullish Reversal Patterns

- **Morning Star**: Three-candle pattern found in downtrends:
  1. Large bearish candle
  2. Small-bodied candle (often a doji) that gaps down
  3. Large bullish candle that closes at least halfway up the first candle
  Represents a potential bottom and shift from bearish to bullish sentiment.

- **Bullish Harami**: Two-candle pattern where a small bullish candle is contained within the body of the previous larger bearish candle. Indicates waning downward momentum.

- **Piercing Line**: Two-candle pattern:
  1. Bearish candle
  2. Bullish candle that opens below the previous candle's low and closes above the midpoint of the previous candle
  Suggests strong buying pressure.

- **Three White Soldiers**: Three consecutive bullish candles, each closing higher than the previous and opening within the previous candle's body. Demonstrates sustained buying pressure.

- **Tweezer Bottom**: Two-candle pattern where the second candle has the same or similar low as the first, but moves in the opposite direction. Forms a support level and suggests reversal.

### Bearish Reversal Patterns

- **Evening Star**: Three-candle pattern found in uptrends:
  1. Large bullish candle
  2. Small-bodied candle (often a doji) that gaps up
  3. Large bearish candle that closes at least halfway down the first candle
  Represents a potential top and shift from bullish to bearish sentiment.

- **Bearish Harami**: Two-candle pattern where a small bearish candle is contained within the body of the previous larger bullish candle. Indicates waning upward momentum.

- **Dark Cloud Cover**: Two-candle pattern:
  1. Bullish candle
  2. Bearish candle that opens above the previous candle's high and closes below the midpoint of the previous candle
  Suggests strong selling pressure.

- **Three Black Crows**: Three consecutive bearish candles, each closing lower than the previous and opening within the previous candle's body. Demonstrates sustained selling pressure.

- **Tweezer Top**: Two-candle pattern where the second candle has the same or similar high as the first, but moves in the opposite direction. Forms a resistance level and suggests reversal.

### Continuation Patterns

- **Rising Three Methods**: Five-candle bullish continuation pattern:
  1. Long bullish candle
  2-4. Three small bearish candles contained within the range of the first candle
  5. Bullish candle that closes above the close of the first candle
  Indicates a temporary pause in an uptrend before continuation.

- **Falling Three Methods**: Five-candle bearish continuation pattern:
  1. Long bearish candle
  2-4. Three small bullish candles contained within the range of the first candle
  5. Bearish candle that closes below the close of the first candle
  Indicates a temporary pause in a downtrend before continuation.

- **Upside/Downside Tasuki Gap**: Three-candle pattern where a gap is partially, but not completely, filled by the third candle. Suggests continuation of the prevailing trend.

- **Separating Lines**: Two candles with the same open price but moving in opposite directions. In an uptrend, the second candle is bullish; in a downtrend, it's bearish. Suggests trend continuation.

## Interpretation and Analysis

### Pattern Reliability Factors

Several factors influence the reliability of candlestick patterns:

- **Trend Context**: Patterns are most reliable when aligned with the overall trend or at key reversal points
- **Volume Confirmation**: Higher volume during pattern formation increases reliability
- **Location**: Patterns at major support/resistance levels or after extended moves have greater significance
- **Candle Size**: Larger candles generally indicate stronger signals
- **Timeframe**: Patterns on higher timeframes (daily, weekly) often provide more significant signals than on very short timeframes
- **Confluence**: Multiple patterns appearing together or with other technical signals strengthen the indication

### Psychological Interpretation

Candlestick patterns reveal market psychology:

- **Long Shadows**: Represent rejection of price extremes and often indicate exhaustion
- **Gaps**: Show strong sentiment that carries from one period to the next
- **Dojis**: Illustrate uncertainty and potential shift in power between buyers and sellers
- **Engulfing Patterns**: Demonstrate one side overpowering the other
- **Star Patterns**: Indicate hesitation after a strong move, often leading to reversal

### Limitations and Considerations

Important factors to consider when using candlestick patterns:

- **False Signals**: No pattern is 100% reliable
- **Confirmation Need**: Wait for additional evidence before taking action
- **Context Dependency**: The same pattern may have different implications in different market conditions
- **Subjectivity**: Some patterns require interpretation and may be viewed differently by different analysts
- **Historical vs. Current Markets**: Patterns developed in 18th century rice markets may behave differently in modern electronic markets

## Applications in Trading

### Trading Strategies

#### Reversal Trading Strategy
1. Identify a strong trend
2. Look for reversal candlestick patterns at overbought/oversold levels
3. Confirm with additional indicators (RSI, Stochastic, volume)
4. Enter position in the direction of the potential reversal
5. Set stop-loss beyond the pattern's extreme point
6. Target previous support/resistance levels for profit-taking

#### Continuation Pattern Strategy
1. Identify the prevailing trend
2. Look for continuation patterns during pullbacks or consolidations
3. Confirm the pattern completion
4. Enter in the direction of the main trend
5. Place stop-loss below key support (uptrend) or above key resistance (downtrend)
6. Set profit targets using trend projection techniques

#### Gap Trading Strategy
1. Identify significant gaps with candlestick formations
2. Assess whether the gap is likely to be filled based on the pattern
3. Enter positions based on gap type (breakaway, runaway, exhaustion)
4. Use tight stop-losses for gap trades due to their volatile nature
5. Consider partial profit-taking at logical levels

### Combining with Other Technical Tools

Candlestick patterns are most effective when used with complementary techniques:

- **Support/Resistance**: Patterns at key levels have increased significance
- **Trend Lines**: Patterns breaking or confirming trend lines provide stronger signals
- **Momentum Indicators**: Divergences between price patterns and indicators like RSI enhance signals
- **Moving Averages**: Patterns near key moving averages often provide actionable signals
- **Volume Analysis**: Volume spikes during pattern formation validate the signal
- **Fibonacci Levels**: Patterns at Fibonacci retracement levels carry greater weight

## Candlestick Patterns Across Different Markets and Timeframes

### Market-Specific Considerations

- **Stock Markets**: Generally respond well to candlestick analysis, with patterns often respecting key price levels
- **Forex Markets**: Patterns may be affected by 24-hour trading and often work best on higher timeframes
- **Cryptocurrency Markets**: High volatility can create exaggerated patterns; focus on strongest formations
- **Futures Markets**: Session-based trading creates patterns around opens/closes of trading sessions
- **Options Markets**: Underlying price patterns influence option pricing and strategy selection

### Timeframe Considerations

- **Intraday (1-minute to Hourly)**: More patterns but higher noise; best for short-term trading
- **Daily**: The standard timeframe for traditional candlestick analysis; provides balanced reliability
- **Weekly/Monthly**: Fewer patterns but highly significant when they appear; best for position trading
- **Multiple Timeframe Approach**: Confirming patterns across different timeframes increases reliability

## Advanced Pattern Recognition

### Pattern Combinations

- **Pattern Clusters**: Multiple patterns appearing in close proximity
- **Failed Patterns**: Patterns that form but fail to follow through, often indicating strong counter-pressure
- **Nested Patterns**: Smaller timeframe patterns within larger timeframe patterns
- **Extended Patterns**: Traditional patterns with additional confirming candles

### Quantitative Analysis of Patterns

- **Statistical Performance**: Historical success rates of different patterns
- **Market-Specific Performance**: How patterns perform in different market conditions
- **Optimization**: Finding the most reliable variations of traditional patterns
- **Machine Learning Applications**: Using algorithms to identify and validate patterns

## Programming Implementation

Python implementation for identifying simple candlestick patterns:

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from mplfinance.original_flavor import candlestick_ohlc
import matplotlib.dates as mdates

def detect_doji(df, doji_height=0.1):
    """
    Detect Doji candlestick patterns
    
    Parameters:
    df (pandas.DataFrame): DataFrame with 'open', 'high', 'low', 'close' columns
    doji_height (float): Maximum body size relative to the candle's range to be considered a doji
    
    Returns:
    pandas.Series: Boolean series indicating where doji patterns are found
    """
    body_size = abs(df['close'] - df['open'])
    candle_range = df['high'] - df['low']
    
    # Avoid division by zero
    candle_range = np.where(candle_range == 0, 0.001, candle_range)
    
    # Calculate body size as a percentage of the range
    body_to_range_ratio = body_size / candle_range
    
    # A doji has a very small body compared to its range
    return body_to_range_ratio <= doji_height

def detect_hammer(df, body_pct=0.3, lower_wick_pct=2.0):
    """
    Detect Hammer candlestick patterns
    
    Parameters:
    df (pandas.DataFrame): DataFrame with 'open', 'high', 'low', 'close' columns
    body_pct (float): Maximum body size relative to candle's range
    lower_wick_pct (float): Minimum lower wick relative to body size
    
    Returns:
    pandas.Series: Boolean series indicating where hammer patterns are found
    """
    # Identify bullish candles (close > open) and bearish candles (close < open)
    bullish = df['close'] > df['open']
    bearish = df['close'] < df['open']
    
    # Calculate body and shadows
    body_size = abs(df['close'] - df['open'])
    upper_shadow = df['high'] - df[['open', 'close']].max(axis=1)
    lower_shadow = df[['open', 'close']].min(axis=1) - df['low']
    candle_range = df['high'] - df['low']
    
    # Avoid division by zero
    body_size = np.where(body_size == 0, 0.001, body_size)
    candle_range = np.where(candle_range == 0, 0.001, candle_range)
    
    # Conditions for a hammer:
    # 1. Small body at the upper part of the candle
    small_body = body_size / candle_range <= body_pct
    
    # 2. Long lower shadow
    long_lower_shadow = lower_shadow / body_size >= lower_wick_pct
    
    # 3. Very small or no upper shadow
    small_upper_shadow = upper_shadow <= body_size * 0.1
    
    return small_body & long_lower_shadow & small_upper_shadow

def detect_engulfing(df):
    """
    Detect Bullish and Bearish Engulfing patterns
    
    Parameters:
    df (pandas.DataFrame): DataFrame with 'open', 'high', 'low', 'close' columns
    
    Returns:
    tuple: Two boolean Series for bullish and bearish engulfing patterns
    """
    # Previous candle data
    prev_open = df['open'].shift(1)
    prev_close = df['close'].shift(1)
    prev_high = df['high'].shift(1)
    prev_low = df['low'].shift(1)
    
    # Current candle data
    curr_open = df['open']
    curr_close = df['close']
    curr_high = df['high']
    curr_low = df['low']
    
    # Previous candle direction
    prev_bullish = prev_close > prev_open
    prev_bearish = prev_close < prev_open
    
    # Current candle direction
    curr_bullish = curr_close > curr_open
    curr_bearish = curr_close < curr_open
    
    # Bullish engulfing: previous bearish + current bullish + current body engulfs previous
    bullish_engulfing = (prev_bearish & 
                        curr_bullish & 
                        curr_open <= prev_close &
                        curr_close >= prev_open)
    
    # Bearish engulfing: previous bullish + current bearish + current body engulfs previous
    bearish_engulfing = (prev_bullish & 
                        curr_bearish & 
                        curr_open >= prev_close &
                        curr_close <= prev_open)
    
    return bullish_engulfing, bearish_engulfing

def plot_candlestick_with_patterns(df, title="Candlestick Chart with Patterns"):
    """
    Plot candlestick chart with highlighted patterns
    
    Parameters:
    df (pandas.DataFrame): DataFrame with 'open', 'high', 'low', 'close' columns and pattern indicators
    title (str): Chart title
    """
    # Convert date to number for matplotlib
    df['date_num'] = mdates.date2num(df.index)
    
    # Create OHLC data
    ohlc = df[['date_num', 'open', 'high', 'low', 'close']].copy()
    
    # Create the figure and axis
    fig, ax = plt.subplots(figsize=(12, 8))
    
    # Plot candlestick chart
    candlestick_ohlc(ax, ohlc.values, width=0.6, colorup='green', colordown='red')
    
    # Format date axis
    ax.xaxis.set_major_formatter(mdates.DateFormatter('%Y-%m-%d'))
    plt.xticks(rotation=45)
    
    # Highlight patterns if present in DataFrame
    if 'doji' in df.columns:
        doji_points = df[df['doji']].index
        for point in doji_points:
            ax.annotate('Doji', (mdates.date2num(point), df.loc[point, 'high']),
                        xytext=(0, 20), textcoords='offset points',
                        arrowprops=dict(arrowstyle='->'), ha='center')
    
    if 'hammer' in df.columns:
        hammer_points = df[df['hammer']].index
        for point in hammer_points:
            ax.annotate('Hammer', (mdates.date2num(point), df.loc[point, 'high']),
                        xytext=(0, 20), textcoords='offset points',
                        arrowprops=dict(arrowstyle='->'), ha='center')
    
    # Set title and labels
    plt.title(title)
    plt.xlabel('Date')
    plt.ylabel('Price')
    plt.grid(True)
    plt.tight_layout()
    plt.show()

# Example usage:
# import yfinance as yf
# data = yf.download('AAPL', start='2021-01-01', end='2021-12-31')
# data['doji'] = detect_doji(data)
# data['hammer'] = detect_hammer(data)
# bullish_eng, bearish_eng = detect_engulfing(data)
# data['bullish_engulfing'] = bullish_eng
# data['bearish_engulfing'] = bearish_eng
# plot_candlestick_with_patterns(data)
```

## Notable Research and Literature

- **"Japanese Candlestick Charting Techniques"** by Steve Nison - The foundational Western text on candlestick analysis
- **"Encyclopedia of Candlestick Charts"** by Thomas Bulkowski - Comprehensive statistical analysis of pattern performance
- **"Beyond Candlesticks"** by Steve Nison - Advanced candlestick techniques and combinations
- **"The Candlestick Course"** by Steve Nison - Practical applications and trading strategies
- **"High Probability Trading Strategies"** by Robert Miner - Integration of candlestick patterns with other technical tools
- **"Trading with Ichimoku Clouds"** by Manesh Patel - Combining candlestick analysis with the Ichimoku system
- Academic studies on the statistical validity of candlestick patterns in modern markets

## Related Technical Analysis Tools

- [Price Action](./price-action.md)
- [Support and Resistance](./support-resistance.md)
- [Chart Patterns](./chart-patterns.md)
- [Trend Lines](./trend-lines.md)
- [Moving Averages](./moving-averages.md)
- [Japanese Charting](./japanese-charting.md) 